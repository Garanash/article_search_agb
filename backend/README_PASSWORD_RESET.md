# Документация по сбросу паролей

## Проблема
После сброса пароля пользователь не может войти в систему.

## Причина
При сбросе пароля администратором:
1. Генерируется новый случайный пароль
2. Пароль сохраняется в базе данных в зашифрованном виде
3. Устанавливается флаг `force_password_change = True`
4. **Пользователь не знает новый пароль**

## Решение

### Для администратора:
1. **Сбросить пароль** через панель администратора
2. **Сохранить сгенерированный пароль** - он показывается только один раз
3. **Передать пароль пользователю** безопасным способом
4. **Предупредить пользователя**, что при первом входе потребуется сменить пароль

### Для пользователя:
1. **Войти с новым паролем**, полученным от администратора
2. **Сменить пароль** при первом входе (система автоматически покажет модальное окно)
3. **Использовать новый пароль** для дальнейших входов

## Процесс сброса пароля

### 1. Администратор сбрасывает пароль
```python
# В панели администратора:
# 1. Найти пользователя
# 2. Нажать "Новый пароль"
# 3. Сохранить сгенерированный пароль
# 4. Передать пользователю
```

### 2. Пользователь входит с новым паролем
```python
# Пользователь вводит:
# Логин: username
# Пароль: новый_пароль_от_администратора
```

### 3. Система требует смену пароля
```python
# Автоматически показывается модальное окно:
# "Требуется смена пароля при первом входе"
# Пользователь вводит новый пароль
```

### 4. Пароль изменен
```python
# Флаг force_password_change = False
# Пользователь может использовать новый пароль
```

## Тестирование

Для проверки работы сброса пароля используйте скрипты:

```bash
# Тест сброса пароля
python test_reset_password.py

# Тест входа с новым паролем
python test_login_with_new_password.py
```

## Важные моменты

1. **Пароль показывается только один раз** при генерации
2. **Администратор должен сохранить пароль** перед закрытием окна
3. **Пользователь должен сменить пароль** при первом входе
4. **Старый пароль больше не работает** после сброса

## Безопасность

- Передавайте пароли безопасным способом
- Не отправляйте пароли по email без шифрования
- Рекомендуйте пользователям использовать сложные пароли
- Пароли автоматически соответствуют требованиям безопасности

## Устранение неполадок

### Пользователь не может войти после сброса пароля:
1. Проверьте, что пароль передан правильно
2. Убедитесь, что пользователь использует новый пароль
3. Проверьте, что флаг `force_password_change = True`
4. Попробуйте сбросить пароль еще раз

### Модальное окно смены пароля не появляется:
1. Проверьте, что флаг `force_password_change = True`
2. Обновите страницу браузера
3. Очистите кэш браузера
4. Проверьте консоль браузера на ошибки 